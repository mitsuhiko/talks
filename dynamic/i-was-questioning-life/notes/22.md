1200 lines of debug infrastructure. More than I would have specified.